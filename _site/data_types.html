<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1. Scrambled data types</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">1. Scrambled data types</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Overview</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">5 simple rules for quality controlling your data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Data Types</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types.html" class="sidebar-item-text sidebar-link active">1. Scrambled data types</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Missing and extra data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing_data.html" class="sidebar-item-text sidebar-link">2. Missing Data</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">1. Scrambled data types</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>This module addresses common errors where string and/or missing data encoded as strings are interwoven with numbers and dates, as well as non-standardized date formatting.</p>
<div class="cell">

</div>
<p>Load packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (datacleanr) <span class="co"># for interactive data viz</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># to homogenize missing value codes</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (tidyverse) <span class="co">#general data wrangling</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (dplyr) <span class="co">#general data wrangling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span><span class="fu">read.csv</span> (<span class="st">'example_data/sunflower_data_broken.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To understand a little bit about the data, it can be helpful to get a brief summary of the contents</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,685
Columns: 8
$ X                    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15…
$ harvest_date         &lt;int&gt; 19970930, 19970930, 19970930, 19970930, 19970930,…
$ harvest_moisture_pct &lt;dbl&gt; 8.4, 9.9, 11.0, 10.0, 10.3, 9.7, 9.7, 8.1, 9.5, 9…
$ height_in            &lt;chr&gt; "57", "62", "56", "60", "58", "58", "66", "60", "…
$ planting_date        &lt;chr&gt; "19970529", "19970529", "19970529", "19970529", "…
$ yield_lb_acre        &lt;dbl&gt; 2542, 2179, 2510, 2225, 2208, 2326, 2319, 2224, 2…
$ Year                 &lt;int&gt; 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1…
$ Hybrid               &lt;chr&gt; "AP2098", "AP3470", "AK7304", "AK7305", "AK7306",…</code></pre>
</div>
</div>
<p>A glimpse at our dataset tells us something about its structure. Ideally, you are the data collector and already know all of this. The first column (X) appears to be an index variable. Sometimes this is intentional; more often it occurs when people write out files in R and forget to include the <code>row.names = F</code> argument. Some things should strike you as potentially problematic about this dataset:</p>
<ol type="1">
<li>There are two date fields, but one is encoded as a character and one as an integer.</li>
<li>Height (with units inches) is encoded as a character.</li>
</ol>
<p>It is very easy to convert everything that <em>should</em> be numeric into a numeric field, but at the risk of wiping out actual data. Better is to suss out what those mystery values are, and why they are there in the first place.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'functions/functions.R'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#define numeric columns</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>non_numeric_cols <span class="ot">&lt;-</span><span class="st">'Hybrid'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(df), non_numeric_cols)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#set up a list to put numeric check results into</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>all_checks <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> numeric_cols) {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  all_checks[[i]] <span class="ot">&lt;-</span> <span class="fu">check_non_numeric</span>(df, i)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>all values are numeric for  X 
all values are numeric for  harvest_date 
all values are numeric for  harvest_moisture_pct </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in check_non_numeric(df, i): Check file for height_in </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in check_non_numeric(df, i): Check file for planting_date </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>all values are numeric for  yield_lb_acre 
all values are numeric for  Year </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># resulting list will just have the things you still need to check</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(all_checks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "height_in"     "planting_date"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(all_checks[[<span class="st">"height_in"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> X </th>
   <th style="text-align:right;"> harvest_date </th>
   <th style="text-align:right;"> harvest_moisture_pct </th>
   <th style="text-align:left;"> height_in </th>
   <th style="text-align:left;"> planting_date </th>
   <th style="text-align:right;"> yield_lb_acre </th>
   <th style="text-align:right;"> Year </th>
   <th style="text-align:left;"> Hybrid </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 19970930 </td>
   <td style="text-align:right;"> 9.5 </td>
   <td style="text-align:left;"> na </td>
   <td style="text-align:left;"> 19970529 </td>
   <td style="text-align:right;"> 2381 </td>
   <td style="text-align:right;"> 1997 </td>
   <td style="text-align:left;"> ST2117 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 475 </td>
   <td style="text-align:right;"> 475 </td>
   <td style="text-align:right;"> 20021031 </td>
   <td style="text-align:right;"> 13.3 </td>
   <td style="text-align:left;"> N/A </td>
   <td style="text-align:left;"> 20020529 </td>
   <td style="text-align:right;"> 2008 </td>
   <td style="text-align:right;"> 2002 </td>
   <td style="text-align:left;"> F00001 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>We can see from the above there are two different missing value codes included in the height column. Having confidence in the issues, we can now set those to a proper missing value code. Here I’m going to run on the assumption that these two missing value codes may be found elsewhere, and replace them everywhere</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#replace non-standard missing value codes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">replace_with_na_all</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> .x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"na"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># resulting list will just have the things you still need to check</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(all_checks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "height_in"     "planting_date"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(all_checks[[<span class="st">"planting_date"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> X </th>
   <th style="text-align:right;"> harvest_date </th>
   <th style="text-align:right;"> harvest_moisture_pct </th>
   <th style="text-align:left;"> height_in </th>
   <th style="text-align:left;"> planting_date </th>
   <th style="text-align:right;"> yield_lb_acre </th>
   <th style="text-align:right;"> Year </th>
   <th style="text-align:left;"> Hybrid </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 867 </td>
   <td style="text-align:right;"> 867 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 11.7 </td>
   <td style="text-align:left;"> 63 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1032 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F30008NS,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 868 </td>
   <td style="text-align:right;"> 868 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 8.2 </td>
   <td style="text-align:left;"> 64 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1244 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F51122NS,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 869 </td>
   <td style="text-align:right;"> 869 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 8.6 </td>
   <td style="text-align:left;"> 66 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1290 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F51137NS,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 870 </td>
   <td style="text-align:right;"> 870 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 9.4 </td>
   <td style="text-align:left;"> 71 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1354 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F51139NS,DM,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 871 </td>
   <td style="text-align:right;"> 871 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 11.0 </td>
   <td style="text-align:left;"> 67 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1236 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F51313NS,DM,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 872 </td>
   <td style="text-align:right;"> 872 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 9.3 </td>
   <td style="text-align:left;"> 64 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 664 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F89036NS,DM,CL </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 873 </td>
   <td style="text-align:right;"> 873 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 10.0 </td>
   <td style="text-align:left;"> 69 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F89057NS,SU </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 874 </td>
   <td style="text-align:right;"> 874 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 8.4 </td>
   <td style="text-align:left;"> 58 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1153 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> F91033NS,SU </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 875 </td>
   <td style="text-align:right;"> 875 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 9.9 </td>
   <td style="text-align:left;"> 65 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 759 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 306 DMR NS </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 876 </td>
   <td style="text-align:right;"> 876 </td>
   <td style="text-align:right;"> 20101021 </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:left;"> 62 </td>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:right;"> 1592 </td>
   <td style="text-align:right;"> 2010 </td>
   <td style="text-align:left;"> 3080 DMR NS </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>It appears that some of the data have dates encoded as an 8 digit integer YYYYMMDD while others have M/D/YYYY. With this information, we can standardize the dates two ways, and then consolidate into a single, proper date column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">planting_date_original =</span> planting_date) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yyyymmdd=</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(planting_date_original),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mdy =</span> lubridate<span class="sc">::</span><span class="fu">mdy</span>(planting_date_original),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">planting_date_corrected =</span> <span class="fu">coalesce</span>(yyyymmdd, mdy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `yyyymmdd = lubridate::ymd(planting_date_original)`.
Caused by warning:
!  145 failed to parse.
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#always check your work</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sanity_test <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2008</span><span class="sc">:</span><span class="dv">2012</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(planting_date_original, planting_date_corrected) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Always check your work!!</p>
<div class="cell">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> planting_date_original </th>
   <th style="text-align:left;"> planting_date_corrected </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 20090527 </td>
   <td style="text-align:left;"> 2009-05-27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5/20/2010 </td>
   <td style="text-align:left;"> 2010-05-20 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20120606 </td>
   <td style="text-align:left;"> 2012-06-06 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Finally, we can remove the temporary columns we created, and set all our remaining columns to the correct column types</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,685
Columns: 8
$ x                    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15…
$ harvest_date         &lt;date&gt; 1997-09-30, 1997-09-30, 1997-09-30, 1997-09-30, …
$ harvest_moisture_pct &lt;dbl&gt; 8.4, 9.9, 11.0, 10.0, 10.3, 9.7, 9.7, 8.1, 9.5, 9…
$ height_in            &lt;dbl&gt; 57, 62, 56, 60, 58, 58, 66, 60, 60, 54, 54, 62, 5…
$ yield_lb_acre        &lt;dbl&gt; 2542, 2179, 2510, 2225, 2208, 2326, 2319, 2224, 2…
$ year                 &lt;int&gt; 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1…
$ hybrid               &lt;chr&gt; "AP2098", "AP3470", "AK7304", "AK7305", "AK7306",…
$ planting_date        &lt;date&gt; 1997-05-29, 1997-05-29, 1997-05-29, 1997-05-29, …</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>